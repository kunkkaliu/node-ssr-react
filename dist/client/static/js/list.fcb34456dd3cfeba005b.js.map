{"version":3,"sources":["webpack:///./src/pages/List/index.less?5635","webpack:///./src/common/less/base.less?62f9","webpack:///./src/utils/mini-refresh.js","webpack:///./src/globalConfig.js","webpack:///./server/network/api.js","webpack:///./server/network/index.js","webpack:///./server/network/net-generate.js","webpack:///./src/pages/List/entry.jsx","webpack:///./src/pages/List/index.jsx"],"names":["content","__webpack_require__","module","i","hmr","transform","insertInto","locals","exports","minirefresh","require","p","n","f","v","h","globalConfig","pending","APICancelToken","axios","CancelToken","removePending","config","length","u","url","method","splice","baseURL","withCredentials","timeout","netConfig","netApi","apiConfig","interceptors","request","use","cancelToken","c","push","error","promise_default","a","reject","response","data","useInterceptors","create","hydrate","react_default","createElement","props","_this","this","_useState","useState","records","_useState2","slicedToArray_default","setRecords","_useState3","pageNum","_useState4","setPageNum","conRef","useRef","refreshRef","fetchRef","useEffect","_ref","current","asyncToGenerator_default","regenerator_default","mark","_callee","num","curNum","res","resData","contentItemList","list","hasMore","wrap","_context","prev","next","api","get","params","catch","err","endDownLoading","endUpLoading","sent","code","concat","stop","_x","apply","arguments","MiniRefresh","MiniRefreshTools","theme","defaults","container","isScrollBar","down","isAuto","callback","up","articleItems","map","item","className","key","id","src","image","data-articleid","href","title","author","time","ref","window","INITIAL_STATE","document","getElementById"],"mappings":"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","file":"static/js/list.fcb34456dd3cfeba005b.js","sourcesContent":["\nvar content = require(\"!!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--9-2!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/less-loader/dist/cjs.js!./index.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--9-2!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/less-loader/dist/cjs.js!./index.less\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--9-2!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/less-loader/dist/cjs.js!./index.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\nvar content = require(\"!!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--9-2!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/less-loader/dist/cjs.js!./base.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--9-2!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/less-loader/dist/cjs.js!./base.less\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/index.js??ref--9-2!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/less-loader/dist/cjs.js!./base.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/* eslint-disable import/no-mutable-exports */\r\nlet minirefresh = {\r\n    default: {},\r\n};\r\n\r\nif (process.env.REACT_ENV === 'client') {\r\n    minirefresh = require('minirefresh');\r\n}\r\n\r\nexport default minirefresh;\r\n","/**\r\n * Created by liudonghui on 2018/6/11.\r\n */\r\nlet apiHost = 'https://zudapang.ltd/api';\r\nlet apiServerHost = 'https://zudapang.ltd/api';\r\n\r\nif (process.env.CODE_ENV === 'qa') {\r\n    apiHost = 'https://zudapang.ltd/api';\r\n    apiServerHost = 'https://zudapang.ltd/api';\r\n} else if (process.env.CODE_ENV === 'online') {\r\n    apiHost = 'https://zudapang.ltd/api';\r\n    apiServerHost = 'https://zudapang.ltd/api';\r\n}\r\n\r\nexport default {\r\n    apiHost,\r\n    apiServerHost,\r\n};\r\n","/**\r\n * Created by liudonghui on 2017/11/4.\r\n * api配置和全局拦截.\r\n */\r\nimport axios from 'axios';\r\nimport globalConfig from '../../src/globalConfig';\r\n\r\nconst pending = []; // 声明一个数组用于存储每个ajax请求的取消函数和ajax标识\r\nconst APICancelToken = axios.CancelToken;\r\nconst removePending = (config) => {\r\n    for (let p = 0; p < pending.length; p += 1) {\r\n        if (pending[p].u === `${config.url}&${config.method}`) { // 当当前请求在数组中存在时执行函数体\r\n            // pending[p].f(); // 执行取消操作\r\n            pending.splice(p, 1); // 把这条记录从数组中移除\r\n        }\r\n    }\r\n};\r\n\r\nexport const config = {\r\n    baseURL: process.env.REACT_ENV === 'server' ? globalConfig.apiServerHost : globalConfig.apiHost,\r\n    withCredentials: false,\r\n    timeout: 10000,\r\n};\r\n\r\nexport function useInterceptors(netApi) {\r\n    // 统一处理所有http请求和响应, 在请求发出与返回时进行拦截, 在这里可以做loading页面的展示与隐藏, token失效是否跳转到登录页等事情;\r\n    netApi.interceptors.request.use((request) => {\r\n        // Do something before request is sent\r\n        removePending(request); // 在一个ajax发送前执行一下取消操作\r\n        request.cancelToken = new APICancelToken((c) => {\r\n            // 这里的ajax标识我是用请求地址&请求方式拼接的字符串，当然你可以选择其他的一些方式\r\n            pending.push({ u: `${request.url}&${request.method}`, f: c });\r\n        });\r\n        return request;\r\n    }, error => Promise.reject(error));\r\n\r\n    netApi.interceptors.response.use((response) => {\r\n        // Do something with response data\r\n        removePending(response.config); // 在一个ajax响应后再执行一下取消操作，把已经完成的请求从pending中移除\r\n        return {\r\n            data: response.data,\r\n        };\r\n    }, error => Promise.reject(error.response && error.response.data));\r\n}\r\n","/**\r\n * Created by liudonghui on 2017/11/4.\r\n */\r\n\r\nimport { config as apiConfig, useInterceptors } from './api';\r\nimport { generateNet } from './net-generate';\r\n\r\nexport const netApi = generateNet(apiConfig, useInterceptors);\r\n\r\n","/**\r\n * Created by liudonghui on 2017/11/4.\r\n */\r\n\r\nimport axios from 'axios';\r\n\r\n/**\r\n * 生成netApi对象\r\n * @param config api配置\r\n * @param useInterceptors 全局拦截器\r\n * @return {AxiosInstance}\r\n */\r\nexport function generateNet(netConfig, useInterceptors) {\r\n    if (process.env.MOCK) {\r\n        const getMockInstance = require('./mock-generate').default;\r\n        const mock = getMockInstance();\r\n        netConfig.adapter = request => new Promise(resolve =>\r\n            mock(request, (response) => {\r\n                setTimeout(() => {\r\n                    if (typeof response.data === 'function') {\r\n                        let { config: { method, params, data } } = response;\r\n                        if (method === 'post') {\r\n                            params = JSON.parse(data);\r\n                        }\r\n                        if (!params) {\r\n                            params = {};\r\n                        }\r\n                        resolve({\r\n                            ...response,\r\n                            data: response.data(params),\r\n                        });\r\n                    } else {\r\n                        resolve(response);\r\n                    }\r\n\r\n                }, 500);\r\n            }));\r\n        netConfig.baseURL = '';\r\n    }\r\n    const netApi = axios.create(netConfig);\r\n    useInterceptors(netApi);\r\n    return netApi;\r\n}\r\n","/**\r\n * Created by liudonghui on 2018/3/7.\r\n */\r\n// import 'babel-polyfill';\r\nimport React from 'react';\r\nimport { hydrate } from 'react-dom';\r\nimport 'common/less/base.less';\r\nimport List from './index';\r\n\r\nhydrate(<List records={window.INITIAL_STATE.records} pageNum={window.INITIAL_STATE.pageNum} />, document.getElementById('root'));\r\n\r\nif (module.hot) {\r\n    module.hot.accept();\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport MiniRefreshTools from '../../utils/mini-refresh';\r\nimport { netApi as api } from '../../../server/network';\r\nimport globalConfig from '../../globalConfig';\r\nimport './index.less';\r\n\r\nexport default function List(props) {\r\n    const [records, setRecords] = useState(props.records || []);\r\n    const [pageNum, setPageNum] = useState(props.pageNum || 1);\r\n    const conRef = useRef(null);\r\n    const refreshRef = useRef(null);\r\n    const fetchRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        fetchRef.current = async (num) => {\r\n            const curNum = num || pageNum;\r\n            const res = await api.get('/hotnews/list', {\r\n                params: {\r\n                    pageNum: curNum,\r\n                },\r\n            }).catch((err) => {\r\n                refreshRef.current.endDownLoading(true);\r\n                refreshRef.current.endUpLoading(false);\r\n            });\r\n            const resData = res.data || {};\r\n            if (resData.code === 0) {\r\n                let contentItemList = records;\r\n                const list = resData.data || [];\r\n                const hasMore = list.length > 0;\r\n                if (hasMore) {\r\n                    refreshRef.current.endUpLoading(false);\r\n                } else {\r\n                    refreshRef.current.endUpLoading(true);\r\n                }\r\n                if (curNum === 1) {\r\n                    contentItemList = [];\r\n                    refreshRef.current.endDownLoading(true);\r\n                }\r\n                setRecords(contentItemList.concat(list));\r\n                setPageNum(hasMore ? curNum + 1 : curNum);\r\n            } else {\r\n                refreshRef.current.endDownLoading(true);\r\n                refreshRef.current.endUpLoading(false);\r\n            }\r\n        };\r\n    }, [pageNum, records]);\r\n\r\n    useEffect(() => {\r\n        const MiniRefresh = MiniRefreshTools.theme.defaults;\r\n        refreshRef.current = new MiniRefresh({\r\n            container: conRef.current,\r\n            isScrollBar: true,\r\n            down: {\r\n                isAuto: false,\r\n                callback: () => {\r\n                    fetchRef.current(1);\r\n                },\r\n            },\r\n            up: {\r\n                isAuto: false,\r\n                callback: () => {\r\n                    fetchRef.current();\r\n                },\r\n            },\r\n        });\r\n    }, []);\r\n\r\n    const articleItems = records.map(item => (\r\n        <div className=\"list-item\" key={item.id} >\r\n            <div className=\"item-img\">\r\n                <img src={`${globalConfig.apiHost}/hotnews/image?imgUrl=https:${item.image}`} />\r\n            </div>\r\n            <div className=\"item-intro\">\r\n                <div data-articleid=\"{{item.id}}\">\r\n                    <a href={`/detail?articleId=${item.id}`}><span className=\"item-title\">{item.title}</span></a>\r\n                </div>\r\n                <div>\r\n                    <span className=\"item-source\">{item.author} | {item.time}</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    ));\r\n\r\n    return (\r\n        <div className=\"container minirefresh-wrap\" ref={conRef}>\r\n            <div className=\"minirefresh-scroll\">\r\n                <div className=\"list-items-wrap\">\r\n                    {articleItems}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"sourceRoot":""}